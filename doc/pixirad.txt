




=== Basic network config ===
The camera has 192.168.0.1/24 adress. The detector pc has to be configured likewise.

Example as an alias on another interface eno1:

auto eno1:1
iface eno1:1 inet static
            address 192.168.0.100
            netmask 255.255.255.0
            mtu 1500

            

=== Advanced system and network tuning ===

The camera will send the images as small (1490) udp datagrams, as fast as it can (87.82 MB/s on december 2015).
The result can be loss of part of the image.

Using FIFO realtime mode can help.
Tuning network buffers can help.
Changing ethernet card can save your skin, and avoid you loosing weeks fine tuning muddy cards.

== Realtime mode ==

In : /etc/security/limits.conf 
Add : 
watier    -       rtprio  5

In soft :
  pthread_t this_thread = pthread_self(); 
  struct sched_param params;     
  params.sched_priority = 5; 
  ret = pthread_setschedparam(this_thread, SCHED_FIFO, &params);
  if (ret != 0) { std::cout << "Check /etc/security/limits.conf " << std::endl; }

  
 == UDP debug tips ==
  If you suspect drop of UDP datagram due to a too small kernel buffer (the plugin is too slow to treat the buffer, it filled and drop frames)
  cat /proc/net/udp
  
  And check the drop column.
  
  cat /proc/sys/net/core/rmem_max  tells you the buffer size 
  by default : 131071
  
  Enough for 100 images (as of 11th of april code):
  net.core.rmem_max = 507217408

  
== Kernel tuning ==
man udp

Change in /etc/sysctl.conf and validate with sysctl -p

net.core.rmem_max = 256217728
net.core.wmem_max = 256217728
net.ipv4.udp_mem = 131072 262144 524288
net.ipv4.udp_rmem_min = 65536
net.core.netdev_max_backlog = 65536 
net.core.somaxconn = 1024



== Network card driver tuning ==
 ethtool -g eth1
Ring parameters for eth1:
Pre-set maximums:
RX:		4096
RX Mini:	0
RX Jumbo:	0
TX:		4096
Current hardware settings:
RX:		512         <<<<<< =====
RX Mini:	0
RX Jumbo:	0
TX:		512

Increased with :
ethtool -G eth1 rx 4096




=== Possible problems with network ===


== List of known to work cards ==
= Embedded motherboard card on optiplex 980:
 Intel Corporation 82578DM Gigabit Network Connection (rev 05)

== List of non working cards ==
= Intel pro 1000 on PCI card (82541GI) (debian 7 & 9):
Intel Corporation 82541GI Gigabit Ethernet Controller
Intel Corporation 82541PI Gigabit Ethernet Controller (rev 05)




=== Possible problems with Chillers ===

The goal is to setup your temperature settings as to have the peltier full time @ max power.

If the peltier is regulating the temperature, stripes appears in the images.

A easy way is to setup a -50C unreachable goal for the detector and let it stabilise to wathever temperature it can reach based on chiller setting.

chiller is supposed to be set at 16degC. go bellow if humidity is well controlled.



